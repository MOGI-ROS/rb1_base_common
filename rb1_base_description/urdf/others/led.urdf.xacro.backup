<?xml version="1.0"?>
<robot xmlns:xacro="http://wiki.ros.org/xacro">


  <xacro:macro name="led" params="prefix parent *origin">


    <joint name="${prefix}led_base_joint" type="fixed">
      <parent link="${parent}"/>
      <child link="${prefix}_base_link"/>
      <xacro:insert_block name="origin" />
    </joint>

    <link name="${prefix}_base_link">
      
      <inertial>
        <origin xyz="0 0 0.5" rpy="0 0 0"/>
        <mass value="1"/>
        <inertia ixx="100"  ixy="0"  ixz="0" iyy="100" iyz="0" izz="100" />
      </inertial>
   
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
          <box size="0.01 0.01 0.01" />
        </geometry>
        <material name="Cyan">
          <color rgba="0 1.0 1.0 1.0"/>
        </material>
      </visual>


        <light>         
            <id>robot_light</id>
            <duration>0.5</duration>
            <interval>0.5</interval>
            <!--color>1 0 0</color-->
        </light>

      </link>
    
<gazebo reference="${prefix}_base_link">

  <!--light name='robot_light_gazebo' type='spot'>
          <pose> 0.25 0 0.3 0 -1.57 0</pose>
          
          <attenuation>
          <range>30</range>
          <constant>0</constant>
          <linear>0.01</linear>
          </attenuation>
          <spot>
              <inner_angle>0.3</inner_angle>
              <outer_angle>0.35</outer_angle>
              <falloff>15</falloff>
          </spot>
          <diffuse>1 0 0 1</diffuse>
          <specular>1 0 0 1</specular>
          

  </light-->



  <light name='robot_light' type='spot'>
      <pose> 0.25 0 0.3 0 -1.57 0</pose>
          
          <attenuation>
          <range>30</range>
          <constant>0</constant>
          <linear>0.01</linear>
          </attenuation>
          <spot>
              <inner_angle>0.3</inner_angle>
              <outer_angle>0.35</outer_angle>
              <falloff>15</falloff>
          </spot>
          <diffuse>1 0 0 1</diffuse>
          <specular>1 0 0 1</specular>
  </light>

   </gazebo>

   <gazebo>

    <plugin name='light_control' filename='libFlashLightPlugin.so'>
          <enable>true</enable>   
           <light>
            <id>${prefix}_base_link/robot_light</id>
            <duration>0.5</duration>
            <interval>0.5</interval>
          </light>    
    </plugin>
   </gazebo>

  </xacro:macro>






</robot>
